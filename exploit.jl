using PyPlot
using JLD2
@load "26.jld2"

r = 2:2:length(Ts)
Ts = Ts[r]
Es = Es[r]
Ss = Ss[r]
Ds = Ds[r]

## Uncomment for production
PyPlot.rc("font", family="serif")
PyPlot.rc("xtick", labelsize="x-small")
PyPlot.rc("ytick", labelsize="x-small")
PyPlot.rc("figure", figsize=(4,3))
PyPlot.rc("text", usetex=false)


figure()
Es = Es .+ 2.36144
Tlim = .011

# Plot tangent lines at each sample point
tangent_length = 0.1 * (maximum(Ts) - minimum(Ts))  # horizontal span
for (xi, fi, fpi, fppi) in zip(Ts, Es, Ss, Ds)
    x_tangent = range(xi - tangent_length, xi + tangent_length, length=20)
    y_tangent = fi .+ fpi .* (x_tangent .- xi) .+ fppi .* (x_tangent .- xi) .^ 2 ./ 2
    plot(x_tangent, y_tangent, "-", color="C1", alpha=0.7)
end

# Plot the function samples
plot(Ts, Es, "o", color="C0", linewidth=2, markersize=6)

xlabel("T (Ha)")
ylabel("F (Ha per cell)")
xlim(0, Tlim)

tight_layout()
savefig("F.pdf")


figure()
plot(Ts, .-Ss, "o", color="C0", linewidth=2, markersize=6)

# Plot tangent lines at each sample point
tangent_length = 0.1 * (maximum(Ts) - minimum(Ts))  # horizontal span
for (xi, fi, fpi, fppi) in zip(Ts, .- Ss, .- Ds, zero(Ds))
    x_tangent = range(xi - tangent_length, xi + tangent_length, length=20)
    y_tangent = fi .+ fpi .* (x_tangent .- xi) .+ fppi .* (x_tangent .- xi) .^ 2 ./ 2
    plot(x_tangent, y_tangent, "-", color="C1", alpha=0.7)
end

xlabel("T (Ha)")
ylabel("S (per cell)")
xlim(0, Tlim)
ylim(bottom=0)

tight_layout()
savefig("S.pdf")
